---
title: "Portfolio Project 2: Image classification using FastAI"
execute: 
  echo: true

format:
  html:
    page-layout: full
    theme:
      light: cosmo
      dark: [cosmo, theme_dark_custom.scss]
    code-link: true
    code-fold: false
engine: python3
---

## Goal
The purpose of this project is to familiarise myself with the `fastai` python package. I will build a simple cat and dog classifier and then a model that can classify all breeds.

## Step 1.0
First, we need to import the `FastAI` package
```{python}
from fastai.vision.all import *
```
Then we want to dowload a dataset of images - in this case labelled cats and dogs.

```{python}
path = untar_data(URLs.PETS)
```

What is inside this dataset?
```{python}
path.ls()
```

How many files are in the dataset?
```{python}
files = get_image_files(path/"images")
len(files)
```

Let's define an easy label function
```{python}
def label_func(f):
  return f[0].isupper()
```

Great! Now we want to stick all of our data into a `DataLoader` object so that we can begin the process of training our model.

```{python}
dls = ImageDataLoaders.from_name_func(path, files, label_func, item_tfms=Resize(224))
```

OK, now let's just take a moment to see that the images are all loaded into the `DataLoader` object properly:
```{python}
dls.show_batch()
```

Looking good! We are now ready to try training a model. We are going to use an old favourite that works quite well while also being quite small - the `ResNet34` model.

```{python}
learn = vision_learner(dls, resnet34, metrics=error_rate)
``` 

```{python}
learn.lr_find()
```